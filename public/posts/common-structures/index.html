<!DOCTYPE html>
<html lang="en-us">
  <head>
    

<meta property="og:title" content="Common Structures" />
<meta property="og:description" content="Common structures Specification Category: Design Last updated: 2021-04 Accurate for: 0.9.49
This document describes some data types common to all I2P protocols, like [I2NP], [I2CP], [SSU], etc.
Common type specification Integer Description Represents a non-negative integer.
Contents 1 to 8 bytes in network byte order (big endian) representing an unsigned integer.
Date Description The number of milliseconds since midnight on January 1, 1970 in the GMT timezone. If the number is 0, the date is undefined or null." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://eyedeekay.github.io/i2p.spec/posts/common-structures/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-04-27T14:39:34-04:00" />
<meta property="article:modified_time" content="2021-04-27T14:39:34-04:00" />



<meta name="description" content="I2P SPecifications" />
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>I2P Specifications</title>
    
<link rel="icon" type="image/png" href="/i2p.spec/images/favicon.png" />
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans:400,600" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="/i2p.spec/style.sass" integrity="">
<link rel="stylesheet" type="text/css" href="/i2p.spec/css/icons.css">

  </head>
  <body>
    
    <div id="preloader">
      <div id="status"></div>
    </div>

    

    

<nav class="navbar is-fresh is-transparent no-shadow" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
        <img src="/i2p.spec/images/logos/fresh.svg" alt="" width="112" height="28">
      </a>
      <a class="navbar-item is-hidden-desktop is-hidden-tablet">
        <div id="menu-icon-wrapper" class="menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

      <div id="navbar-menu" class="navbar-menu is-static">
        <div class="navbar-start">
          <a class="navbar-item is-hidden-mobile">
            <div id="menu-icon-wrapper" class="menu-icon-wrapper" style="visibility: visible;">
              <svg width="1000px" height="1000px">
                <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
                <path class="path2" d="M 300 500 L 700 500"></path>
                <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
              </svg>
              <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
            </div>
          </a>
        </div>

        <div class="navbar-end">
          <a href="/" class="navbar-item is-secondary">
            Features
          </a>
          <a href="/" class="navbar-item is-secondary">
            Pricing
          </a>
          <div class="navbar-item has-dropdown is-hoverable">
            <a class="navbar-link">
              Dropdown
            </a>

            <div class="navbar-dropdown">
              <a href="/" class="navbar-item">
                Dropdown item
              </a>
              <a href="/" class="navbar-item">
                Dropdown item
              </a>
              <a href="/" class="navbar-item">
                Dropdown item
              </a>
            </div>
          </div>
          <a href="/" class="navbar-item is-secondary">
            Log in
          </a>
          <a href="/" class="navbar-item">
            <span class="button signup-button rounded secondary-btn raised">
              Sign up
            </span>
          </a>
        </div>
      </div>
  </div>
</nav>



<nav id="navbar-clone" class="navbar is-fresh is-transparent" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">
      <a class="navbar-item" href="/">
        <img src="/i2p.spec/images/logos/fresh.svg" alt="" width="112" height="28">
      </a>
      <a class="navbar-item is-hidden-desktop is-hidden-tablet">
        <div id="menu-icon-wrapper" class="menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
      </a>

      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="cloned-navbar-menu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>

    <div id="cloned-navbar-menu" class="navbar-menu is-fixed">
      <div class="navbar-start">
        <a class="navbar-item is-hidden-mobile">
          <div id="cloned-menu-icon-wrapper" class="menu-icon-wrapper" style="visibility: visible;">
            <svg width="1000px" height="1000px">
              <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
              <path class="path2" d="M 300 500 L 700 500"></path>
              <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
            </svg>
            <button id="cloned-menu-icon-trigger" class="menu-icon-trigger"></button>
          </div>
        </a>
      </div>

      <div class="navbar-end">
        <a href="/" class="navbar-item is-secondary">
          Features
        </a>
        <a href="/" class="navbar-item is-secondary">
          Pricing
        </a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link">
            Dropdown
          </a>

          <div class="navbar-dropdown">
            <a href="/" class="navbar-item">
              Dropdown item
            </a>
            <a href="/" class="navbar-item">
              Dropdown item
            </a>
            <a href="/" class="navbar-item">
              Dropdown item
            </a>
          </div>
        </div>
        <a href="/" class="navbar-item is-secondary">
          Log in
        </a>
        <a href="/" class="navbar-item">
          <span class="button signup-button rounded secondary-btn raised">
            Sign up
          </span>
        </a>
      </div>
    </div>
</div>
</nav>

<section class="section is-medium">
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title section-title">Common Structures</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
      </div>
    </div>
    <h1 id="common-structures-specification">Common structures Specification</h1>
<p>Category: Design Last updated: 2021-04 Accurate for: 0.9.49</p>
<p>This document describes some data types common to all I2P protocols,
like [I2NP], [I2CP], [SSU], etc.</p>
<h2 id="common-type-specification">Common type specification</h2>
<h3 id="type-Integer">Integer</h3>
<h4 id="description">Description</h4>
<p>Represents a non-negative integer.</p>
<h4 id="contents">Contents</h4>
<p>1 to 8 bytes in network byte order (big endian) representing an unsigned
integer.</p>
<h3 id="type-Date">Date</h3>
<h4 id="description-1">Description</h4>
<p>The number of milliseconds since midnight on January 1, 1970 in the GMT
timezone. If the number is 0, the date is undefined or null.</p>
<h4 id="contents-1">Contents</h4>
<p>8 byte <a href="#integer">Integer</a></p>
<h3 id="type-String">String</h3>
<h4 id="description-2">Description</h4>
<p>Represents a UTF-8 encoded string.</p>
<h4 id="contents-2">Contents</h4>
<p>1 or more bytes where the first byte is the number of bytes (not
characters!) in the string and the remaining 0-255 bytes are the
non-null terminated UTF-8 encoded character array. Length limit is 255
bytes (not characters). Length may be 0.</p>
<h3 id="type-PublicKey">PublicKey</h3>
<h4 id="description-3">Description</h4>
<p>This structure is used in ElGamal or other asymmetric encryption,
representing only the exponent, not the primes, which are constant and
defined in the cryptography specification [ELGAMAL]. Other encryption
schemes are in the process of being defined, see the table below.</p>
<h4 id="contents-3">Contents</h4>
<p>Key type and length are inferred from context or are specified in the
Key Certificate of a Destination or RouterInfo, or the fields in a
<a href="#leaseset2">LeaseSet2</a> or other data structure. The default type is
ElGamal. As of release 0.9.38, other types may be supported, depending
on context. Keys are big-endian unless otherwise noted.</p>
<p>X25519 keys are supported in Destinations and LeaseSet2 as of release
0.9.44. X25519 keys are supported in RouterIdentities as of release
0.9.48.</p>
<p>+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| Type    | Length (bytes) | Since  | Usage                 |
+=========+================+========+=======================+
| ElGamal | &gt; 256          |        | All Router Identities |
|         |                |        | and Destinations      |
+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| P256    | &gt; 64           | &gt; TBD  | Reserved, see         |
|         |                |        | proposal 145          |
+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| P384    | &gt; 96           | &gt; TBD  | Reserved, see         |
|         |                |        | proposal 145          |
+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| P521    | &gt; 132          | &gt; TBD  | Reserved, see         |
|         |                |        | proposal 145          |
+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| X25519  | &gt; 32           | 0.9.38 | Little-endian. See    |
|         |                |        | [ECIES] and         |
|         |                |        | [ECIES-ROUTERS]     |
+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+</p>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/PublicKey.html">http://echelon.i2p/javadoc/net/i2p/data/PublicKey.html</a></p>
<h3 id="type-PrivateKey">PrivateKey</h3>
<h4 id="description-4">Description</h4>
<p>This structure is used in ElGamal or other asymmetric decryption,
representing only the exponent, not the primes which are constant and
defined in the cryptography specification [ELGAMAL]. Other encryption
schemes are in the process of being defined, see the table below.</p>
<h4 id="contents-4">Contents</h4>
<p>Key type and length are inferred from context or are stored separately
in a data structure or a private key file. The default type is ElGamal.
As of release 0.9.38, other types may be supported, depending on
context. Keys are big-endian unless otherwise noted.</p>
<p>+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| Type    | Length (bytes) | Since  | Usage                 |
+=========+================+========+=======================+
| ElGamal | &gt; 256          |        | All Router Identities |
|         |                |        | and Destinations      |
+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| P256    | &gt; 32           | &gt; TBD  | Reserved, see         |
|         |                |        | proposal 145          |
+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| P384    | &gt; 48           | &gt; TBD  | Reserved, see         |
|         |                |        | proposal 145          |
+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| P521    | &gt; 66           | &gt; TBD  | Reserved, see         |
|         |                |        | proposal 145          |
+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| X25519  | &gt; 32           | 0.9.38 | Little-endian. See    |
|         |                |        | [ECIES] and         |
|         |                |        | [ECIES-ROUTERS]     |
+&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+</p>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/PrivateKey.html">http://echelon.i2p/javadoc/net/i2p/data/PrivateKey.html</a></p>
<h3 id="type-SessionKey">SessionKey</h3>
<h4 id="description-5">Description</h4>
<p>This structure is used for symmetric AES256 encryption and decryption.</p>
<h4 id="contents-5">Contents</h4>
<p>32 bytes</p>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/SessionKey.html">http://echelon.i2p/javadoc/net/i2p/data/SessionKey.html</a></p>
<h3 id="type-SigningPublicKey">SigningPublicKey</h3>
<h4 id="description-6">Description</h4>
<p>This structure is used for verifying signatures.</p>
<h4 id="contents-6">Contents</h4>
<p>Key type and length are inferred from context or are specified in the
Key Certificate of a Destination. The default type is DSA_SHA1. As of
release 0.9.12, other types may be supported, depending on context.</p>
<p>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| Type             | Length (bytes) | Since  | Usage            |
+==================+================+========+==================+
| DSA_SHA1        | &gt; 128          |        | Legacy Router    |
|                  |                |        | Identities and   |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| ECD              | &gt; 64           | 0.9.12 | Recent           |
| SA_SHA256_P256 |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| ECD              | &gt; 96           | 0.9.12 | Rarely used for  |
| SA_SHA384_P384 |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| ECD              | &gt; 132          | 0.9.12 | Rarely used for  |
| SA_SHA512_P521 |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| R                | &gt; 256          | 0.9.12 | Offline signing, |
| SA_SHA256_2048 |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities or    |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| R                | &gt; 384          | 0.9.12 | Offline signing, |
| SA_SHA384_3072 |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities or    |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| R                | &gt; 512          | 0.9.12 | Offline signing, |
| SA_SHA512_4096 |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities or    |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| EdDSA\           | &gt; 32           | 0.9.15 | Recent Router    |
| _SHA512_Ed25519 |                |        | Identities and   |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| EdDSA_S         | &gt; 32           | 0.9.25 | Offline signing, |
| HA512_Ed25519ph |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities or    |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| RedDSA\          | &gt; 32           | 0.9.39 | For Destinations |
| _SHA512_Ed25519 |                |        | and encrypted    |
|                  |                |        | leasesets only,  |
|                  |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities       |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+</p>
<h4 id="notes">Notes</h4>
<ul>
<li>When a key is composed of two elements (for example points X,Y), it
is serialized by padding each element to length/2 with leading zeros
if necessary.</li>
<li>All types are Big Endian, except for EdDSA and RedDSA, which are
stored and transmitted in a Little Endian format.</li>
</ul>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/SigningPublicKey.html">http://echelon.i2p/javadoc/net/i2p/data/SigningPublicKey.html</a></p>
<h3 id="type-SigningPrivateKey">SigningPrivateKey</h3>
<h4 id="description-7">Description</h4>
<p>This structure is used for creating signatures.</p>
<h4 id="contents-7">Contents</h4>
<p>Key type and length are specified when created. The default type is
DSA_SHA1. As of release 0.9.12, other types may be supported, depending
on context.</p>
<p>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| Type             | Length (bytes) | Since  | Usage            |
+==================+================+========+==================+
| DSA_SHA1        | &gt; 20           |        | Legacy Router    |
|                  |                |        | Identities and   |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| ECD              | &gt; 32           | 0.9.12 | Recent           |
| SA_SHA256_P256 |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| ECD              | &gt; 48           | 0.9.12 | Rarely used for  |
| SA_SHA384_P384 |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| ECD              | &gt; 66           | 0.9.12 | Rarely used for  |
| SA_SHA512_P521 |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| R                | &gt; 512          | 0.9.12 | Offline signing, |
| SA_SHA256_2048 |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities or    |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| R                | &gt; 768          | 0.9.12 | Offline signing, |
| SA_SHA384_3072 |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities or    |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| R                | &gt; 1024         | 0.9.12 | Offline signing, |
| SA_SHA512_4096 |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities or    |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| EdDSA\           | &gt; 32           | 0.9.15 | Recent Router    |
| _SHA512_Ed25519 |                |        | Identities and   |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| EdDSA_S         | &gt; 32           | 0.9.25 | Offline signing, |
| HA512_Ed25519ph |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities or    |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| RedDSA\          | &gt; 32           | 0.9.39 | For Destinations |
| _SHA512_Ed25519 |                |        | and encrypted    |
|                  |                |        | leasesets only,  |
|                  |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities       |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+</p>
<h4 id="notes-1">Notes</h4>
<ul>
<li>When a key is composed of two elements (for example points X,Y), it
is serialized by padding each element to length/2 with leading zeros
if necessary.</li>
<li>All types are Big Endian, except for EdDSA and RedDSA, which are
stored and transmitted in a Little Endian format.</li>
</ul>
<p>JavaDoc:
<a href="http://echelon.i2p/javadoc/net/i2p/data/SigningPrivateKey.html">http://echelon.i2p/javadoc/net/i2p/data/SigningPrivateKey.html</a></p>
<h3 id="type-Signature">Signature</h3>
<h4 id="description-8">Description</h4>
<p>This structure represents the signature of some data.</p>
<h4 id="contents-8">Contents</h4>
<p>Signature type and length are inferred from the type of key used. The
default type is DSA_SHA1. As of release 0.9.12, other types may be
supported, depending on context.</p>
<p>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| Type             | Length (bytes) | Since  | Usage            |
+==================+================+========+==================+
| DSA_SHA1        | &gt; 40           |        | Legacy Router    |
|                  |                |        | Identities and   |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| ECD              | &gt; 64           | 0.9.12 | Recent           |
| SA_SHA256_P256 |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| ECD              | &gt; 96           | 0.9.12 | Rarely used for  |
| SA_SHA384_P384 |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| ECD              | &gt; 132          | 0.9.12 | Rarely used for  |
| SA_SHA512_P521 |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| R                | &gt; 256          | 0.9.12 | Offline signing, |
| SA_SHA256_2048 |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities or    |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| R                | &gt; 384          | 0.9.12 | Offline signing, |
| SA_SHA384_3072 |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities or    |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| R                | &gt; 512          | 0.9.12 | Offline signing, |
| SA_SHA512_4096 |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities or    |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| EdDSA\           | &gt; 64           | 0.9.15 | Recent Router    |
| _SHA512_Ed25519 |                |        | Identities and   |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| EdDSA_S         | &gt; 64           | 0.9.25 | Offline signing, |
| HA512_Ed25519ph |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities or    |
|                  |                |        | Destinations     |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| RedDSA\          | &gt; 64           | 0.9.39 | For Destinations |
| _SHA512_Ed25519 |                |        | and encrypted    |
|                  |                |        | leasesets only,  |
|                  |                |        | never used for   |
|                  |                |        | Router           |
|                  |                |        | Identities       |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+</p>
<h4 id="notes-2">Notes</h4>
<ul>
<li>When a signature is composed of two elements (for example values
R,S), it is serialized by padding each element to length/2 with
leading zeros if necessary.</li>
<li>All types are Big Endian, except for EdDSA and RedDSA, which are
stored and transmitted in a Little Endian format.</li>
</ul>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/Signature.html">http://echelon.i2p/javadoc/net/i2p/data/Signature.html</a></p>
<h3 id="type-Hash">Hash</h3>
<h4 id="description-9">Description</h4>
<p>Represents the SHA256 of some data.</p>
<h4 id="contents-9">Contents</h4>
<p>32 bytes</p>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/Hash.html">http://echelon.i2p/javadoc/net/i2p/data/Hash.html</a></p>
<h3 id="type-SessionTag">Session Tag</h3>
<p>Note: Session Tags for ECIES-X25519 destinations (ratchet) and
ECIES-X25519 routers are 8 bytes. See [ECIES] and [ECIES-ROUTERS].</p>
<h4 id="description-10">Description</h4>
<p>A random number</p>
<h4 id="contents-10">Contents</h4>
<p>32 bytes</p>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/SessionTag.html">http://echelon.i2p/javadoc/net/i2p/data/SessionTag.html</a></p>
<h3 id="type-TunnelId">TunnelId</h3>
<h4 id="description-11">Description</h4>
<p>Defines an identifier that is unique to each router in a tunnel. A
Tunnel ID is generally greater than zero; do not use a value of zero
except in special cases.</p>
<h4 id="contents-11">Contents</h4>
<p>4 byte <a href="#integer">Integer</a></p>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/TunnelId.html">http://echelon.i2p/javadoc/net/i2p/data/TunnelId.html</a></p>
<h3 id="type-Certificate">Certificate</h3>
<h4 id="description-12">Description</h4>
<p>A certificate is a container for various receipts or proof of works used
throughout the I2P network.</p>
<h4 id="contents-12">Contents</h4>
<p>1 byte <a href="#integer">Integer</a> specifying certificate type, followed by a 2
byte <a href="#integer">Integer</a> specifying the size of the certificate payload,
then that many bytes.</p>
<blockquote>
<p>+----+----+----+----+----+-// length | payload
+----+----+----+----+----+-//</p>
<dl>
<dt>type :: [Integer]</dt>
<dd>length -&gt; 1 byte
<p>case 0 -&gt; NULL case 1 -&gt; HASHCASH case 2 -&gt; HIDDEN case 3 -&gt;
SIGNED case 4 -&gt; MULTIPLE case 5 -&gt; KEY</p>
</dd>
<dt>length :: [Integer]</dt>
<dd>length -&gt; 2 bytes</dd>
<dt>payload :: data</dt>
<dd>length -&gt; $length bytes</dd>
</dl>
</blockquote>
<p>[Integer]: /spec/common-structures#type-integer</p>
<h4 id="notes-3">Notes</h4>
<ul>
<li>For <a href="#struct_RouterIdentity">Router Identities</a>, the Certificate is
always NULL through version 0.9.15. As of 0.9.16, a Key Certificate
may be used to specify the signing public key type. See below.</li>
<li>For <a href="/en/docs/spec/i2np#struct_GarlicClove">Garlic Cloves</a>, the
Certificate is always NULL, no others are currently implemented.</li>
<li>For <a href="/en/docs/spec/i2np#msg_Garlic">Garlic Messages</a>, the
Certificate is always NULL, no others are currently implemented.</li>
<li>For <a href="#struct_Destination">Destinations</a>, the Certificate may be
non-NULL. As of 0.9.12, a Key Certificate may be used to specify the
signing public key type. See below.</li>
<li>Implementers are cautioned to prohibit excess data in Certificates.
The appropriate length for each certificate type should be enforced.</li>
</ul>
<h4 id="certificate-types">Certificate Types</h4>
<p>The following certificate types are defined:</p>
<p>+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| Type     | Type Code | Payload      | Total Length | Notes        |
|          |           | Length       |              |              |
+==========+===========+==============+==============+==============+
| Null     | &gt; 0       | &gt; 0          | &gt; 3          |              |
+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| HashCash | &gt; 1       | &gt; varies     | &gt; varies     | E            |
|          |           |              |              | xperimental, |
|          |           |              |              | unused.      |
|          |           |              |              | Payload      |
|          |           |              |              | contains an  |
|          |           |              |              | ASCII        |
|          |           |              |              | col          |
|          |           |              |              | on-separated |
|          |           |              |              | hashcash     |
|          |           |              |              | string.      |
+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| Hidden   | &gt; 2       | &gt; 0          | &gt; 3          | E            |
|          |           |              |              | xperimental, |
|          |           |              |              | unused.      |
|          |           |              |              | Hidden       |
|          |           |              |              | routers      |
|          |           |              |              | generally do |
|          |           |              |              | not announce |
|          |           |              |              | that they    |
|          |           |              |              | are hidden.  |
+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| Signed   | &gt; 3       | &gt; 40 or 72   | &gt; 43 or 75   | E            |
|          |           |              |              | xperimental, |
|          |           |              |              | unused.      |
|          |           |              |              | Payload      |
|          |           |              |              | contains a   |
|          |           |              |              | 40-byte DSA  |
|          |           |              |              | signature,   |
|          |           |              |              | optionally   |
|          |           |              |              | followed by  |
|          |           |              |              | the 32-byte  |
|          |           |              |              | Hash of the  |
|          |           |              |              | signing      |
|          |           |              |              | Destination. |
+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| Multiple | &gt; 4       | &gt; varies     | &gt; varies     | E            |
|          |           |              |              | xperimental, |
|          |           |              |              | unused.      |
|          |           |              |              | Payload      |
|          |           |              |              | contains     |
|          |           |              |              | multiple     |
|          |           |              |              | c            |
|          |           |              |              | ertificates. |
+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| Key      | &gt; 5       | &gt; 4+         | &gt; 7+         | Since        |
|          |           |              |              | 0.9.12. See  |
|          |           |              |              | below for    |
|          |           |              |              | details.     |
+&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+</p>
<h4 id="key-certificates">Key Certificates</h4>
<p>Key certificates were introduced in release 0.9.12. Prior to that
release, all PublicKeys were 256-byte ElGamal keys, and all
SigningPublicKeys were 128-byte DSA-SHA1 keys. A key certificate
provides a mechanism to indicate the type of the PublicKey and
SigningPublicKey in the Destination or RouterIdentity, and to package
any key data in excess of the standard lengths.</p>
<p>By maintaining exactly 384 bytes before the certificate, and putting any
excess key data inside the certificate, we maintain compatibility for
any software that parses Destinations and Router Identities.</p>
<p>The key certificate payload contains:</p>
<p>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+
| Data                                          | Length |
+===============================================+========+
| Signing Public Key Type (<a href="#integer">Integer</a>) | &gt; 2    |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+
| Crypto Public Key Type (<a href="#integer">Integer</a>)  | &gt; 2    |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+
| Excess Signing Public Key Data                | &gt; 0+   |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+
| Excess Crypto Public Key Data                 | &gt; 0+   |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+</p>
<p>The defined Signing Public Key types are:</p>
<p>+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| Type         | Type Code   | Total Public | Since  | Usage        |
|              |             | Key Length   |        |              |
+==============+=============+==============+========+==============+
| DSA_SHA1    | &gt; 0         | &gt; 128        | 0.9.12 | Legacy       |
|              |             |              |        | Router       |
|              |             |              |        | Identities   |
|              |             |              |        | and          |
|              |             |              |        | D            |
|              |             |              |        | estinations, |
|              |             |              |        | never        |
|              |             |              |        | explicitly   |
|              |             |              |        | set          |
+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| ECDSA_      | &gt; 1         | &gt; 64         | 0.9.12 | Older        |
| SHA256_P256 |             |              |        | Destinations |
+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| ECDSA_      | &gt; 2         | &gt; 96         | 0.9.12 | Rarely if    |
| SHA384_P384 |             |              |        | ever used    |
|              |             |              |        | for          |
|              |             |              |        | Destinations |
+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| ECDSA_      | &gt; 3         | &gt; 132        | 0.9.12 | Rarely if    |
| SHA512_P521 |             |              |        | ever used    |
|              |             |              |        | for          |
|              |             |              |        | Destinations |
+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| RSA_        | &gt; 4         | &gt; 256        | 0.9.12 | Offline      |
| SHA256_2048 |             |              |        | only; never  |
|              |             |              |        | used in Key  |
|              |             |              |        | Certificates |
|              |             |              |        | for Router   |
|              |             |              |        | Identities   |
|              |             |              |        | or           |
|              |             |              |        | Destinations |
+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| RSA_        | &gt; 5         | &gt; 384        | 0.9.12 | Offline      |
| SHA384_3072 |             |              |        | only; never  |
|              |             |              |        | used in Key  |
|              |             |              |        | Certificates |
|              |             |              |        | for Router   |
|              |             |              |        | Identities   |
|              |             |              |        | or           |
|              |             |              |        | Destinations |
+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| RSA_        | &gt; 6         | &gt; 512        | 0.9.12 | Offline      |
| SHA512_4096 |             |              |        | only; never  |
|              |             |              |        | used in Key  |
|              |             |              |        | Certificates |
|              |             |              |        | for Router   |
|              |             |              |        | Identities   |
|              |             |              |        | or           |
|              |             |              |        | Destinations |
+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| EdDSA_SHA   | &gt; 7         | &gt; 32         | 0.9.15 | Recent       |
| 512_Ed25519 |             |              |        | Router       |
|              |             |              |        | Identities   |
|              |             |              |        | and          |
|              |             |              |        | Destinations |
+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| EdDSA_SHA51 | &gt; 8 9 10    | &gt; 32 64 128  | 0.9.25 | Offline      |
| 2_Ed25519ph |             |              |        | only; never  |
| reserved     |             |              |        | used in Key  |
| (GOST)       |             |              |        | Certificates |
| reserved     |             |              |        | for Router   |
| (GOST)       |             |              |        | Identities   |
|              |             |              |        | or           |
|              |             |              |        | Destinations |
|              |             |              |        | Reserved,    |
|              |             |              |        | see proposal |
|              |             |              |        | 134          |
|              |             |              |        | Reserved,    |
|              |             |              |        | see proposal |
|              |             |              |        | 134          |
+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+
| RedDSA_SHA  | &gt; 11        | &gt; 32         | 0.9.39 | For          |
| 512_Ed25519 |             |              |        | Destinations |
| reserved     | 65280-65534 |              |        | and          |
| reserved     |             |              |        | encrypted    |
|              | :   65535   |              |        | leasesets    |
|              |             |              |        | only; never  |
|              |             |              |        | used for     |
|              |             |              |        | Router       |
|              |             |              |        | Identities   |
|              |             |              |        | Reserved for |
|              |             |              |        | experimental |
|              |             |              |        | use Reserved |
|              |             |              |        | for future   |
|              |             |              |        | expansion    |
+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&ndash;+</p>
<p>The defined Crypto Public Key types are:</p>
<p>+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| Type            | Type Code   | Total Public    | Usage           |
|                 |             | Key Length      |                 |
+=================+=============+=================+=================+
| ElGamal         | &gt; 0         | &gt; 256           | All Router      |
|                 |             |                 | Identities and  |
|                 |             |                 | Destinations    |
+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| P256            | &gt; 1         | &gt; 64            | Reserved, see   |
|                 |             |                 | proposal 145    |
+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| P384            | &gt; 2         | &gt; 96            | Reserved, see   |
|                 |             |                 | proposal 145    |
+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| P521            | &gt; 3         | &gt; 132           | Reserved, see   |
|                 |             |                 | proposal 145    |
+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
| X25519 reserved | &gt; 4         | &gt; 32            | See [ECIES]   |
| reserved        |             |                 | and proposal    |
|                 | 65280-65534 |                 | 156 Reserved    |
|                 |             |                 | for             |
|                 | :   65535   |                 | experimental    |
|                 |             |                 | use Reserved    |
|                 |             |                 | for future      |
|                 |             |                 | expansion       |
+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+</p>
<p>When a Key Certificate is not present, the preceeding 384 bytes in the
Destination or RouterIdentity are defined as the 256-byte ElGamal
PublicKey followed by the 128-byte DSA-SHA1 SigningPublicKey. When a Key
Certificate is present, the preceeding 384 bytes are redefined as
follows:</p>
<ul>
<li>Complete or first portion of Crypto Public Key</li>
<li>Random padding if the total lengths of the two keys are less than
384 bytes</li>
<li>Complete or first portion of Signing Public Key</li>
</ul>
<p>The Crypto Public Key is aligned at the start and the Signing Public Key
is aligned at the end. The padding (if any) is in the middle. The
lengths and boundaries of the initial key data, the padding, and the
excess key data portions in the certificates are not explicitly
specified, but are derived from the lengths of the specified key types.
If the total lengths of the Crypto and Signing Public Keys exceed 384
bytes, the remainder will be contained in the Key Certificate. If the
Crypto Public Key length is not 256 bytes, the method for determining
the boundary between the two keys is to be specified in a future
revision of this document.</p>
<p>Example layouts using an ElGamal Crypto Public Key and the Signing
Public Key type indicated:</p>
<p>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| Signing Key Type         | Padding Length | Excess Signing Key Data in Cert |
+==========================+================+=================================+
| DSA_SHA1                | &gt; 0            | &gt; 0                             |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| ECDSA_SHA256_P256      | &gt; 64           | &gt; 0                             |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| ECDSA_SHA384_P384      | &gt; 32           | &gt; 0                             |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| ECDSA_SHA512_P521      | &gt; 0            | &gt; 4                             |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| RSA_SHA256_2048        | &gt; 0            | &gt; 128                           |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| RSA_SHA384_3072        | &gt; 0            | &gt; 256                           |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| RSA_SHA512_4096        | &gt; 0            | &gt; 384                           |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| EdDSA_SHA512_Ed25519   | &gt; 96           | &gt; 0                             |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
| EdDSA_SHA512_Ed25519ph | &gt; 96           | &gt; 0                             |
+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+</p>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/Certificate.html">http://echelon.i2p/javadoc/net/i2p/data/Certificate.html</a></p>
<h4 id="notes-4">Notes</h4>
<ul>
<li>Implementers are cautioned to prohibit excess data in Key
Certificates. The appropriate length for each certificate type
should be enforced.</li>
</ul>
<h3 id="type-Mapping">Mapping</h3>
<h4 id="description-13">Description</h4>
<p>A set of key/value mappings or properties</p>
<h4 id="contents-13">Contents</h4>
<p>A 2-byte size Integer followed by a series of String=String; pairs</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+ |
size | key_string (len + data)| = |
+----+----+----+----+----+----+----+----+ |
val_string (len + data) | ; | ...
+----+----+----+----+----+----+----+ size ::
[Integer] length -&gt; 2 bytes Total number of bytes that follow</p>
<dl>
<dt>key_string :: [String]</dt>
<dd>A string (one byte length followed by UTF-8 encoded characters)</dd>
</dl>
<p>= :: A single byte containing '='</p>
<dl>
<dt>val_string :: [String]</dt>
<dd>A string (one byte length followed by UTF-8 encoded characters)</dd>
</dl>
<p>; :: A single byte containing ';'</p>
</blockquote>
<p>[Integer]: /spec/common-structures#type-integer [String]:
/spec/common-structures#type-string</p>
<h4 id="notes-5">Notes</h4>
<ul>
<li>The encoding isn't optimal - we either need the '=' and ';'
characters, or the string lengths, but not both</li>
<li>Some documentation says that the strings may not include '=' or
';' but this encoding supports them</li>
<li>Strings are defined to be UTF-8 but in the current implementation,
I2CP uses UTF-8 but I2NP does not. For example, UTF-8 strings in a
RouterInfo options mapping in a I2NP Database Store Message will be
corrupted.</li>
<li>The encoding allows duplicate keys, however in any usage where the
mapping is signed, duplicates may cause a signature failure.</li>
<li>Mappings contained in I2NP messages (i.e. in a RouterAddress or
RouterInfo) must be sorted by key so that the signature will be
invariant. Duplicate keys are not allowed.</li>
<li>Mappings contained in an <a href="/en/docs/spec/i2cp#struct_SessionConfig">I2CP
SessionConfig</a> must be
sorted by key so that the signature will be invariant. Duplicate
keys are not allowed.</li>
<li>The sort method is defined as in Java String.compareTo(), using the
Unicode value of the characters.</li>
<li>While it is application-dependent, keys and values are generally
case-sensitive.</li>
<li>Key and value string length limits are 255 bytes (not characters)
each, plus the length byte. Length byte may be 0.</li>
<li>Total length limit is 65535 bytes, plus the 2 byte size field, or
65537 total.</li>
</ul>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/DataHelper.html">http://echelon.i2p/javadoc/net/i2p/data/DataHelper.html</a></p>
<h2 id="common-structure-specification">Common structure specification</h2>
<h3 id="struct-KeysAndCert">KeysAndCert</h3>
<h4 id="description-14">Description</h4>
<p>An encryption public key, a signing public key, and a certificate, used
as either a RouterIdentity or a Destination.</p>
<h4 id="contents-14">Contents</h4>
<p>A <a href="#publickey">PublicKey</a> followed by a
<a href="#signingpublickey">SigningPublicKey</a> and then a
<a href="#certificate">Certificate</a>.</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+ |
public_key | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
padding (optional) | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
signing_key | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
certificate | +----+----+----+-//</p>
<dl>
<dt>public_key :: [PublicKey] (partial or full)</dt>
<dd>length -&gt; 256 bytes or as specified in key certificate</dd>
<dt>padding :: random data</dt>
<dd>length -&gt; 0 bytes or as specified in key certificate padding
length + signing_key length == 128 bytes</dd>
<dt>signing__key :: [SigningPublicKey] (partial or full)</dt>
<dd>length -&gt; 128 bytes or as specified in key certificate padding
length + signing_key length == 128 bytes</dd>
<dt>certificate :: [Certificate]</dt>
<dd>length -&gt; &gt;= 3 bytes</dd>
</dl>
<p>total length: 387+ bytes</p>
</blockquote>
<p>[PublicKey]: /spec/common-structures#type-publickey
[SigningPublicKey]: /spec/common-structures#type-signingpublickey
[Certificate]: /spec/common-structures#type-certificate</p>
<h4 id="notes-6">Notes</h4>
<ul>
<li>Do not assume that these are always 387 bytes! They are 387 bytes
plus the certificate length specified at bytes 385-386, which may be
non-zero.</li>
<li>As of release 0.9.12, if the certificate is a Key Certificate, the
boundaries of the key fields may vary. See the Key Certificate
section above for details.</li>
<li>The Crypto Public Key is aligned at the start and the Signing Public
Key is aligned at the end. The padding (if any) is in the middle.</li>
</ul>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/KeysAndCert.html">http://echelon.i2p/javadoc/net/i2p/data/KeysAndCert.html</a></p>
<h3 id="struct-RouterIdentity">RouterIdentity</h3>
<h4 id="description-15">Description</h4>
<p>Defines the way to uniquely identify a particular router</p>
<h4 id="contents-15">Contents</h4>
<p>Identical to KeysAndCert.</p>
<h4 id="notes-7">Notes</h4>
<ul>
<li>The certificate for a RouterIdentity was always NULL until release
0.9.12.</li>
<li>Do not assume that these are always 387 bytes! They are 387 bytes
plus the certificate length specified at bytes 385-386, which may be
non-zero.</li>
<li>As of release 0.9.12, if the certificate is a Key Certificate, the
boundaries of the key fields may vary. See the Key Certificate
section above for details.</li>
<li>The Crypto Public Key is aligned at the start and the Signing Public
Key is aligned at the end. The padding (if any) is in the middle.</li>
<li>RouterIdentities with a key certificate and a ECIES_X25519 public
key are supported as of release 0.9.48. Prior to that, all
RouterIdentities were ElGamal.</li>
</ul>
<p>JavaDoc:
<a href="http://echelon.i2p/javadoc/net/i2p/data/router/RouterIdentity.html">http://echelon.i2p/javadoc/net/i2p/data/router/RouterIdentity.html</a></p>
<h3 id="struct-Destination">Destination</h3>
<h4 id="description-16">Description</h4>
<p>A Destination defines a particular endpoint to which messages can be
directed for secure delivery.</p>
<h4 id="contents-16">Contents</h4>
<p>Identical to <a href="#keysandcert">KeysAndCert</a>.</p>
<h4 id="notes-8">Notes</h4>
<ul>
<li>The public key of the destination was used for the old i2cp-to-i2cp
encryption which was disabled in version 0.6, it is currently unused
except for the IV for LeaseSet encryption, which is deprecated. The
public key in the LeaseSet is used instead.</li>
<li>Do not assume that these are always 387 bytes! They are 387 bytes
plus the certificate length specified at bytes 385-386, which may be
non-zero.</li>
<li>As of release 0.9.12, if the certificate is a Key Certificate, the
boundaries of the key fields may vary. See the Key Certificate
section above for details.</li>
<li>The Crypto Public Key is aligned at the start and the Signing Public
Key is aligned at the end. The padding (if any) is in the middle.</li>
</ul>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/Destination.html">http://echelon.i2p/javadoc/net/i2p/data/Destination.html</a></p>
<h3 id="struct-Lease">Lease</h3>
<h4 id="description-17">Description</h4>
<p>Defines the authorization for a particular tunnel to receive messages
targeting a <a href="#destination">Destination</a>.</p>
<h4 id="contents-17">Contents</h4>
<p>SHA256 <a href="#hash">Hash</a> of the <a href="#routeridentity">RouterIdentity</a> of the
gateway router, then the <a href="#tunnelid">TunnelId</a>, and finally an end
<a href="#date">Date</a>.</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+ |
tunnel_gw | + + | | + + | | + + | |
+----+----+----+----+----+----+----+----+ |
tunnel_id | end_date
+----+----+----+----+----+----+----+----+ |
+----+----+----+----+</p>
<dl>
<dt>tunnel_gw :: Hash of the [RouterIdentity] of the tunnel gateway</dt>
<dd>length -&gt; 32 bytes</dd>
<dt>tunnel_id :: [TunnelId]</dt>
<dd>length -&gt; 4 bytes</dd>
<dt>end_date :: [Date]</dt>
<dd>length -&gt; 8 bytes</dd>
</dl>
</blockquote>
<p>[Date]: /spec/common-structures#type-date [TunnelId]:
/spec/common-structures#type-tunnelid [RouterIdentity]:
/spec/common-structures#struct-routeridentity</p>
<h4 id="notes-9">Notes</h4>
<ul>
<li>Total size: 44 bytes</li>
</ul>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/Lease.html">http://echelon.i2p/javadoc/net/i2p/data/Lease.html</a></p>
<h3 id="struct-LeaseSet">LeaseSet</h3>
<h4 id="description-18">Description</h4>
<p>Contains all of the currently authorized <a href="#struct-lease">Leases</a> for a
particular <a href="#destination">Destination</a>, the <a href="#publickey">PublicKey</a> to
which garlic messages can be encrypted, and then the
<a href="#signingpublickey">SigningPublicKey</a> that can be used to revoke this
particular version of the structure. The LeaseSet is one of the two
structures stored in the network database (the other being
<a href="#routerinfo">RouterInfo</a>), and is keyed under the SHA256 of the
contained <a href="#destination">Destination</a>.</p>
<h4 id="contents-18">Contents</h4>
<p><a href="#destination">Destination</a>, followed by a <a href="#publickey">PublicKey</a> for
encryption, then a <a href="#signingpublickey">SigningPublicKey</a> which can be
used to revoke this version of the LeaseSet, then a 1 byte
<a href="#integer">Integer</a> specifying how many <a href="#lease">Lease</a> structures are
in the set, followed by the actual <a href="#lease">Lease</a> structures and
finally a <a href="#signature">Signature</a> of the previous bytes signed by the
<a href="#destination">Destination</a>'s <a href="#signingprivatekey">SigningPrivateKey</a>.</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+ |
destination | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
encryption_key | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
signing_key | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
num| Lease 0 | +----+ + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
Lease 1 | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
Lease ($num-1) | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
signature | + + | | + + | | + + | | + + | |
+----+----+----+----+----+----+----+----+</p>
<dl>
<dt>destination :: [Destination]</dt>
<dd>length -&gt; &gt;= 387+ bytes</dd>
<dt>encryption_key :: [PublicKey]</dt>
<dd>length -&gt; 256 bytes</dd>
<dt>signing_key :: [SigningPublicKey]</dt>
<dd><dl>
<dt>length -&gt; 128 bytes or as specified in destination's key</dt>
<dd>
<p>certificate</p>
</dd>
</dl>
</dd>
<dt>num :: [Integer]</dt>
<dd>length -&gt; 1 byte Number of leases to follow value: 0 &lt;= num &lt;=
16</dd>
<dt>leases :: [[Lease]]</dt>
<dd>length -&gt; $num*44 bytes</dd>
<dt>signature :: [Signature]</dt>
<dd><dl>
<dt>length -&gt; 40 bytes or as specified in destination's key</dt>
<dd>
<p>certificate</p>
</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>[Destination]: /spec/common-structures#struct-destination
[PublicKey]: /spec/common-structures#type-publickey [Signature]:
/spec/common-structures#type-signature [Integer]:
/spec/common-structures#type-integer [SigningPublicKey]:
/spec/common-structures#type-signingpublickey [Lease]:
/spec/common-structures#struct-lease</p>
<h4 id="notes-10">Notes</h4>
<ul>
<li>The public key of the destination was used for the old I2CP-to-I2CP
encryption which was disabled in version 0.6, it is currently
unused.</li>
<li>The encryption key is used for end-to-end ElGamal/AES+SessionTag
encryption [ELGAMAL-AES]. It is currently generated anew at every
router startup, it is not persistent.</li>
<li>The signature may be verified using the signing public key of the
destination.</li>
<li>A LeaseSet with zero Leases is allowed but is unused. It was
intended for LeaseSet revocation, which is unimplemented. All
LeaseSet2 variants require at least one Lease.</li>
<li>The signing_key is currently unused. It was intended for LeaseSet
revocation, which is unimplemented. It is currently generated anew
at every router startup, it is not persistent. The signing key type
is always the same as the destination's signing key type.</li>
<li>The earliest expiration of all the Leases is treated as the
timestamp or version of the LeaseSet. Routers will generally not
accept a store of a LeaseSet unless it is &quot;newer&quot; than the current
one. Take care when publishing a new LeaseSet where the oldest Lease
is the same as the oldest Lease in the previous LeaseSet. The
publishing router should generally increment the expiration of the
oldest Lease by at least 1 ms in that case.</li>
<li>Prior to release 0.9.7, when included in a DatabaseStore Message
sent by the originating router, the router set all the published
leases' expirations to the same value, that of the earliest lease.
As of release 0.9.7, the router publishes the actual lease
expiration for each lease. This is an implementation detail and not
part of the structures specification.</li>
</ul>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/LeaseSet.html">http://echelon.i2p/javadoc/net/i2p/data/LeaseSet.html</a></p>
<h3 id="struct-Lease2">Lease2</h3>
<h4 id="description-19">Description</h4>
<p>Defines the authorization for a particular tunnel to receive messages
targeting a <a href="#destination">Destination</a>. Same as <a href="#lease">Lease</a> but
with a 4-byte end_date. Used by <a href="#leaseset2">LeaseSet2</a>. Supported as
of 0.9.38; see proposal 123 for more information.</p>
<h4 id="contents-19">Contents</h4>
<p>SHA256 <a href="#hash">Hash</a> of the <a href="#routeridentity">RouterIdentity</a> of the
gateway router, then the <a href="#tunnelid">TunnelId</a>, and finally a 4 byte end
date.</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+ |
tunnel_gw | + + | | + + | | + + | |
+----+----+----+----+----+----+----+----+ |
tunnel_id | end_date |
+----+----+----+----+----+----+----+----+</p>
<dl>
<dt>tunnel_gw :: Hash of the [RouterIdentity] of the tunnel gateway</dt>
<dd>length -&gt; 32 bytes</dd>
<dt>tunnel_id :: [TunnelId]</dt>
<dd>length -&gt; 4 bytes</dd>
<dt>end_date :: 4 byte date</dt>
<dd>length -&gt; 4 bytes Seconds since the epoch, rolls over in 2106.</dd>
</dl>
</blockquote>
<p>[TunnelId]: /spec/common-structures#type-tunnelid [RouterIdentity]:
/spec/common-structures#struct-routeridentity</p>
<h4 id="notes-11">Notes</h4>
<ul>
<li>Total size: 40 bytes</li>
</ul>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/Lease2.html">http://echelon.i2p/javadoc/net/i2p/data/Lease2.html</a></p>
<h3 id="struct-OfflineSignature">OfflineSignature</h3>
<h4 id="description-20">Description</h4>
<p>This is an optional part of the <a href="#leaseset2header">LeaseSet2Header</a>.
Also used in streaming and I2CP. Supported as of 0.9.38; see proposal
123 for more information.</p>
<h4 id="contents-20">Contents</h4>
<p>Contains an expiration, a sigtype and transient
<a href="#signingpublickey">SigningPublicKey</a>, and a <a href="#signature">Signature</a>.</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+ |
expires | sigtype | |
+----+----+----+----+----+----+ + |
transient_public_key | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
signature | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+</p>
<dl>
<dt>expires :: 4 byte date</dt>
<dd>length -&gt; 4 bytes Seconds since the epoch, rolls over in 2106.</dd>
<dt>sigtype :: 2 byte type of the transient_public_key</dt>
<dd>length -&gt; 2 bytes</dd>
<dt>transient_public_key :: [SigningPublicKey]</dt>
<dd>length -&gt; As inferred from the sigtype</dd>
<dt>signature :: [Signature]</dt>
<dd><dl>
<dt>length -&gt; As inferred from the sigtype of the signing public key</dt>
<dd>
<p>in the [Destination] that preceded this offline signature.</p>
</dd>
</dl>
Signature of expires timestamp, transient sig type, and public
key, by the destination public key.</dd>
</dl>
</blockquote>
<p>[Destination]: /spec/common-structures#struct-destination
[SigningPublicKey]: /spec/common-structures#type-signingpublickey
[Signature]: /spec/common-structures#type-signature</p>
<h4 id="notes-12">Notes</h4>
<ul>
<li>This section can, and should, be generated offline.</li>
</ul>
<h3 id="struct-LeaseSet2Header">LeaseSet2Header</h3>
<h4 id="description-21">Description</h4>
<p>This is the common part of the <a href="#leaseset2">LeaseSet2</a> and
<a href="#metaleaseset">MetaLeaseSet</a>. Supported as of 0.9.38; see proposal 123
for more information.</p>
<h4 id="contents-21">Contents</h4>
<p>Contains the <a href="#destination">Destination</a>, two timestamps, and an
optional <a href="#offlinesignature">OfflineSignature</a>.</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+ |
destination | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
published | expires | flags |
+----+----+----+----+----+----+----+----+ |
offline_signature (optional) | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+</p>
<dl>
<dt>destination :: [Destination]</dt>
<dd>length -&gt; &gt;= 387+ bytes</dd>
<dt>published :: 4 byte date</dt>
<dd>length -&gt; 4 bytes Seconds since the epoch, rolls over in 2106.</dd>
<dt>expires :: 2 byte time</dt>
<dd>length -&gt; 2 bytes Offset from published timestamp in seconds,
18.2 hours max</dd>
<dt>flags :: 2 bytes</dt>
<dd>Bit order: 15 14 ... 3 2 1 0 Bit 0: If 0, no offline keys; if 1,
offline keys Bit 1: If 0, a standard published leaseset. If 1, an
unpublished leaseset. Should not be flooded, published, or sent in
response to a query. If this leaseset expires, do not query the
netdb for a new one, unless bit 2 is set. Bit 2: If 0, a standard
published leaseset. If 1, this unencrypted leaseset will be
blinded and encrypted when published. If this leaseset expires,
query the blinded location in the netdb for a new one. If this bit
is set to 1, set bit 1 to 1 also. As of release 0.9.42. Bits 15-3:
set to 0 for compatibility with future uses</dd>
<dt>offline_signature :: [OfflineSignature]</dt>
<dd>length -&gt; varies Optional, only present if bit 0 is set in the
flags.</dd>
</dl>
</blockquote>
<p>[OfflineSignature]: /spec/common-structures#struct-offlinesignature
[Destination]: /spec/common-structures#struct-destination</p>
<h4 id="notes-13">Notes</h4>
<ul>
<li>Total size: 395 bytes minimum</li>
<li>Maximum actual expires time is about 660 (11 minutes) for
<a href="#leaseset2">LeaseSet2</a> and 65535 (the full 18.2 hours) for
<a href="#metaleaseset">MetaLeaseSet</a>.</li>
</ul>
<h3 id="struct-LeaseSet2">LeaseSet2</h3>
<h4 id="description-22">Description</h4>
<p>Contained in a I2NP DatabaseStore message of type 3. Supported as of
0.9.38; see proposal 123 for more information.</p>
<p>Contains all of the currently authorized <a href="#lease2">Lease2</a> for a
particular <a href="#destination">Destination</a>, and the <a href="#publickey">PublicKey</a>
to which garlic messages can be encrypted. A LeaseSet is one of the two
structures stored in the network database (the other being
<a href="#routerinfo">RouterInfo</a>), and is keyed under the SHA256 of the
contained <a href="#destination">Destination</a>.</p>
<h4 id="contents-22">Contents</h4>
<p><a href="#leaseset2header">LeaseSet2Header</a>, followed by a options, then one or
more <a href="#publickey">PublicKey</a> for encryption, <a href="#integer">Integer</a>
specifying how many <a href="#lease2">Lease2</a> structures are in the set,
followed by the actual <a href="#lease2">Lease2</a> structures and finally a
<a href="#signature">Signature</a> of the previous bytes signed by the
<a href="#destination">Destination</a>'s <a href="#signingprivatekey">SigningPrivateKey</a>
or the transient key.</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+ |
ls2_header | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
options | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+
keytype0| keylen0 | | +----+----+----+----+----+ +
| encryption_key_0 | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
keytypen| keylenn | | +----+----+----+----+ + |
encryption_key_n | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
num| Lease2 0 | +----+ + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
Lease2($num-1) | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
signature | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+</p>
<dl>
<dt>ls2header :: [LeaseSet2Header]</dt>
<dd>length -&gt; varies</dd>
<dt>options :: [Mapping]</dt>
<dd>length -&gt; varies, 2 bytes minimum</dd>
<dt>numk :: [Integer]</dt>
<dd>length -&gt; 1 byte Number of key types, key lengths, and
[PublicKey]s to follow value: 1 &lt;= numk &lt;= max TBD</dd>
<dt>keytype :: The encryption type of the [PublicKey] to follow.</dt>
<dd>length -&gt; 2 bytes</dd>
<dt>keylen :: The length of the [PublicKey] to follow.</dt>
<dd>Must match the specified length of the encryption type. length -&gt;
2 bytes</dd>
<dt>encryption_key :: [PublicKey]</dt>
<dd>length -&gt; 256 bytes</dd>
<dt>num :: [Integer]</dt>
<dd>length -&gt; 1 byte Number of [Lease2]s to follow value: 0 &lt;= num
&lt;= 16</dd>
<dt>leases :: [[Lease2]]</dt>
<dd>length -&gt; $num*40 bytes</dd>
<dt>signature :: [Signature]</dt>
<dd><dl>
<dt>length -&gt; 40 bytes or as specified in destination's key</dt>
<dd>
<p>certificate, or by the sigtype of the transient public key, if
present in the header</p>
</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>[Mapping]: /spec/common-structures#type-mapping [PublicKey]:
/spec/common-structures#type-publickey [Signature]:
/spec/common-structures#type-signature [Integer]:
/spec/common-structures#type-integer [Lease2]:
/spec/common-structures#struct-lease2 [LeaseSet2Header]:
/spec/common-structures#struct-leaseset2header</p>
<h4 id="notes-14">Notes</h4>
<ul>
<li>The public key of the destination was used for the old I2CP-to-I2CP
encryption which was disabled in version 0.6, it is currently
unused.</li>
<li>The encryption keys are used for end-to-end ElGamal/AES+SessionTag
encryption [ELGAMAL-AES] (type 0) or other end-to-end encryption
schemes. See [ECIES] and proposals 145 and 156. They may be
generated anew at every router startup or they may be persistent.
X25519 (type 4, see [ECIES] ) is supported as of release 0.9.44.</li>
<li>The signature is over the data above, PREPENDED with the single byte
containing the DatabaseStore type (3).</li>
<li>The signature may be verified using the signing public key of the
destination, or the transient signing public key, if an offline
signature is included in the leaseset2 header.</li>
<li>The key length is provided for each key, so that floodfills and
clients may parse the structure even if not all encryption types are
known or supported.</li>
</ul>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/LeaseSet2.html">http://echelon.i2p/javadoc/net/i2p/data/LeaseSet2.html</a></p>
<h3 id="struct-MetaLease">MetaLease</h3>
<h4 id="description-23">Description</h4>
<p>Defines the authorization for a particular tunnel to receive messages
targeting a <a href="#destination">Destination</a>. Same as <a href="#lease2">Lease2</a> but
with flags and cost instead of a tunnel id. Used by
<a href="#metaleaseset">MetaLeaseSet</a>. Contained in a I2NP DatabaseStore message
of type 7. Supported as of 0.9.38; see proposal 123 for more
information.</p>
<h4 id="contents-23">Contents</h4>
<p>SHA256 <a href="#hash">Hash</a> of the <a href="#routeridentity">RouterIdentity</a> of the
gateway router, then flags and cost, and finally a 4 byte end date.</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+ |
tunnel_gw | + + | | + + | | + + | |
+----+----+----+----+----+----+----+----+ |
flags end_date |
+----+----+----+----+----+----+----+----+</p>
<dl>
<dt>tunnel_gw :: Hash of the [RouterIdentity] of the tunnel gateway,</dt>
<dd>or the hash of another [MetaLeaseSet]. length -&gt; 32 bytes</dd>
<dt>flags :: 3 bytes of flags</dt>
<dd>Bit order: 23 22 ... 3 2 1 0 Bits 3-0: Type of the entry. If 0,
unknown. If 1, a [LeaseSet]. If 3, a [LeaseSet2]. If 5, a
[MetaLeaseSet]. Bits 23-4: set to 0 for compatibility with
future uses length -&gt; 3 bytes</dd>
<dt>cost :: 1 byte, 0-255. Lower value is higher priority.</dt>
<dd>length -&gt; 1 byte</dd>
<dt>end_date :: 4 byte date</dt>
<dd>length -&gt; 4 bytes Seconds since the epoch, rolls over in 2106.</dd>
</dl>
</blockquote>
<p>[MetaLeaseSet]: /spec/common-structures#struct-metaleaseset
[LeaseSet]: /spec/common-structures#struct-leaseset [LeaseSet2]:
/spec/common-structures#struct-leaseset2 [RouterIdentity]:
/spec/common-structures#struct-routeridentity</p>
<h4 id="notes-15">Notes</h4>
<ul>
<li>Total size: 40 bytes</li>
</ul>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/MetaLease.html">http://echelon.i2p/javadoc/net/i2p/data/MetaLease.html</a></p>
<h3 id="struct-MetaLeaseSet">MetaLeaseSet</h3>
<h4 id="description-24">Description</h4>
<p>Contained in a I2NP DatabaseStore message of type 7. Defined as of
0.9.38; scheduled to be working as of 0.9.40; see proposal 123 for more
information.</p>
<p>Contains all of the currently authorized <a href="#metalease">MetaLease</a> for a
particular <a href="#destination">Destination</a>, and the <a href="#publickey">PublicKey</a>
to which garlic messages can be encrypted. A LeaseSet is one of the two
structures stored in the network database (the other being
<a href="#routerinfo">RouterInfo</a>), and is keyed under the SHA256 of the
contained <a href="#destination">Destination</a>.</p>
<h4 id="contents-24">Contents</h4>
<p><a href="#leaseset2header">LeaseSet2Header</a>, followed by a options,
<a href="#integer">Integer</a> specifying how many <a href="#lease2">Lease2</a> structures are
in the set, followed by the actual <a href="#lease2">Lease2</a> structures and
finally a <a href="#signature">Signature</a> of the previous bytes signed by the
<a href="#destination">Destination</a>'s <a href="#signingprivatekey">SigningPrivateKey</a>
or the transient key.</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+ |
ls2_header | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
options | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
num| MetaLease 0 | +----+ + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
MetaLease($num-1) | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
+----+ + | revocation_0 | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
revocation_n | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
signature | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+</p>
<dl>
<dt>ls2header :: [LeaseSet2Header]</dt>
<dd>length -&gt; varies</dd>
<dt>options :: [Mapping]</dt>
<dd>length -&gt; varies, 2 bytes minimum</dd>
<dt>num :: [Integer]</dt>
<dd>length -&gt; 1 byte Number of [MetaLease]s to follow value: 1 &lt;=
num &lt;= max TBD</dd>
<dt>leases :: [MetaLease]s</dt>
<dd>length -&gt; $numr*40 bytes</dd>
<dt>numr :: [Integer]</dt>
<dd>length -&gt; 1 byte Number of [Hash]es to follow value: 0 &lt;= numr
&lt;= max TBD</dd>
<dt>revocations :: [[Hash]]</dt>
<dd>length -&gt; $numr*32 bytes</dd>
<dt>signature :: [Signature]</dt>
<dd><dl>
<dt>length -&gt; 40 bytes or as specified in destination's key</dt>
<dd>
<p>certificate, or by the sigtype of the transient public key, if
present in the header</p>
</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>[Hash]: /spec/common-structures#type-hash [MetaLease]:
/spec/common-structures#struct-metalease [Mapping]:
/spec/common-structures#type-mapping [Signature]:
/spec/common-structures#type-signature [Integer]:
/spec/common-structures#type-integer [LeaseSet2Header]:
/spec/common-structures#struct-leaseset2header</p>
<h4 id="notes-16">Notes</h4>
<ul>
<li>The public key of the destination was used for the old I2CP-to-I2CP
encryption which was disabled in version 0.6, it is currently
unused.</li>
<li>The signature is over the data above, PREPENDED with the single byte
containing the DatabaseStore type (7).</li>
<li>The signature may be verified using the signing public key of the
destination, or the transient signing public key, if an offline
signature is included in the leaseset2 header.</li>
</ul>
<p>JavaDoc: <a href="http://echelon.i2p/javadoc/net/i2p/data/MetaLeaseSet.html">http://echelon.i2p/javadoc/net/i2p/data/MetaLeaseSet.html</a></p>
<h3 id="struct-EncryptedLeaseSet">EncryptedLeaseSet</h3>
<h4 id="description-25">Description</h4>
<p>Contained in a I2NP DatabaseStore message of type 5. Defined as of
0.9.38; working as of 0.9.39; see proposal 123 for more information.</p>
<p>Only the blinded key and expiration are visible in cleartext. The actual
lease set is encrypted.</p>
<h4 id="contents-25">Contents</h4>
<p>A two byte signature type, the blinded
<a href="#signingprivatekey">SigningPrivateKey</a>, published time, expiration, and
flags. Then, a two byte length followed by encrypted data. Finally, a
<a href="#signature">Signature</a> of the previous bytes signed by the blinded
<a href="#signingprivatekey">SigningPrivateKey</a> or the transient key.</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+ |
sigtype | | +----+----+ + | blinded_public_key | ~ ~ ~
~ | |
+----+----+----+----+----+----+----+----+ |
published | expires | flags |
+----+----+----+----+----+----+----+----+ |
offline_signature (optional) | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
len | | +----+----+ + | encrypted_data | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
signature | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+</p>
<dl>
<dt>sigtype :: A two byte signature type of the public key to follow</dt>
<dd>length -&gt; 2 bytes</dd>
<dt>blinded_public_key :: [SigningPublicKey]</dt>
<dd>length -&gt; As inferred from the sigtype</dd>
<dt>published :: 4 byte date</dt>
<dd>length -&gt; 4 bytes Seconds since the epoch, rolls over in 2106.</dd>
<dt>expires :: 2 byte time</dt>
<dd>length -&gt; 2 bytes Offset from published timestamp in seconds,
18.2 hours max</dd>
<dt>flags :: 2 bytes</dt>
<dd>Bit order: 15 14 ... 3 2 1 0 Bit 0: If 0, no offline keys; if 1,
offline keys Bit 1: If 0, a standard published leaseset. If 1, an
unpublished leaseset. Should not be flooded, published, or sent in
response to a query. If this leaseset expires, do not query the
netdb for a new one. Bits 15-2: set to 0 for compatibility with
future uses</dd>
<dt>offline_signature :: [OfflineSignature]</dt>
<dd>length -&gt; varies Optional, only present if bit 0 is set in the
flags.</dd>
<dt>len :: [Integer]</dt>
<dd>length -&gt; 2 bytes length of encrypted_data to follow value: 1
&lt;= num &lt;= max TBD</dd>
<dt>encrypted_data :: Data encrypted</dt>
<dd>length -&gt; len bytes</dd>
<dt>signature :: [Signature]</dt>
<dd><dl>
<dt>length -&gt; As specified by the sigtype of the blinded pubic key,</dt>
<dd>
<p>or by the sigtype of the transient public key, if present in
the header</p>
</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>[OfflineSignature]: /spec/common-structures#struct-offlinesignature
[SigningPublicKey]: /spec/common-structures#type-signingpublickey
[Signature]: /spec/common-structures#type-signature [Integer]:
/spec/common-structures#type-integer</p>
<h4 id="notes-17">Notes</h4>
<ul>
<li>The public key of the destination was used for the old I2CP-to-I2CP
encryption which was disabled in version 0.6, it is currently
unused.</li>
<li>The signature is over the data above, PREPENDED with the single byte
containing the DatabaseStore type (5).</li>
<li>The signature may be verified using the signing public key of the
destination, or the transient signing public key, if an offline
signature is included in the leaseset2 header.</li>
<li>Blinding and encryption are specified in
<a href="/en/docs/spec/encryptedleaseset">EncryptedLeaseSet</a></li>
<li>This structure does not use the <a href="#leaseset2header">LeaseSet2Header</a>.</li>
<li>Maximum actual expires time is about 660 (11 minutes), unless it is
an encrypted <a href="#metaleaseset">MetaLeaseSet</a>.</li>
<li>See proposal 123 for notes on using offline signatures with
encrypted leasesets.</li>
</ul>
<p>JavaDoc:
<a href="http://echelon.i2p/javadoc/net/i2p/data/EncryptedLeaseSet.html">http://echelon.i2p/javadoc/net/i2p/data/EncryptedLeaseSet.html</a></p>
<h3 id="struct-RouterAddress">RouterAddress</h3>
<h4 id="description-26">Description</h4>
<p>This structure defines the means to contact a router through a transport
protocol.</p>
<h4 id="contents-26">Contents</h4>
<p>1 byte <a href="#integer">Integer</a> defining the relative cost of using the
address, where 0 is free and 255 is expensive, followed by the
expiration <a href="#date">Date</a> after which the address should not be used, or
if null, the address never expires. After that comes a <a href="#string">String</a>
defining the transport protocol this router address uses. Finally there
is a <a href="#mapping">Mapping</a> containing all of the transport specific
options necessary to establish the connection, such as IP address, port
number, email address, URL, etc.</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+
expiration
+----+----+----+----+----+----+----+----+ |
transport_style |
+----+----+----+----+-//-+----+----+----+ | | +</p>
<ul>
<li>| options | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+</li>
</ul>
<dl>
<dt>cost :: [Integer]</dt>
<dd>length -&gt; 1 byte
<p>case 0 -&gt; free case 255 -&gt; expensive</p>
</dd>
<dt>expiration :: [Date] (must be all zeros, see notes below)</dt>
<dd>length -&gt; 8 bytes
<p>case null -&gt; never expires</p>
</dd>
<dt>transport_style :: [String]</dt>
<dd>length -&gt; 1-256 bytes</dd>
</dl>
<p>options :: [Mapping]</p>
</blockquote>
<p>[Date]: /spec/common-structures#type-date [Integer]:
/spec/common-structures#type-integer [String]:
/spec/common-structures#type-string [Mapping]:
/spec/common-structures#type-mapping</p>
<h4 id="notes-18">Notes</h4>
<ul>
<li>Cost is typically 5 or 6 for SSU, and 10 or 11 for NTCP.</li>
<li>Expiration is currently unused, always null (all zeroes). As of
release 0.9.3, the expiration is assumed zero and not stored, so any
non-zero expiration will fail in the RouterInfo signature
verification. Implementing expiration (or another use for these
bytes) will be a backwards-incompatible change. Routers MUST set
this field to all zeros. As of release 0.9.12, a non-zero expiration
field is again recognized, however we must wait several releases to
use this field, until the vast majority of the network recognizes
it.</li>
<li>The following options, while not required, are standard and expected
to be present in most router addresses: &quot;host&quot; (an IPv4 or IPv6
address or host name) and &quot;port&quot;.</li>
</ul>
<p>JavaDoc:
<a href="http://echelon.i2p/javadoc/net/i2p/data/router/RouterAddress.html">http://echelon.i2p/javadoc/net/i2p/data/router/RouterAddress.html</a></p>
<h3 id="struct-RouterInfo">RouterInfo</h3>
<h4 id="description-27">Description</h4>
<p>Defines all of the data that a router wants to publish for the network
to see. The <a href="#routerinfo">RouterInfo</a> is one of two structures stored in
the network database (the other being <a href="#leaseset">LeaseSet</a>), and is
keyed under the SHA256 of the contained
<a href="#routeridentity">RouterIdentity</a>.</p>
<h4 id="contents-27">Contents</h4>
<p><a href="#routeridentity">RouterIdentity</a> followed by the <a href="#date">Date</a>, when
the entry was published</p>
<blockquote>
<p>+----+----+----+----+----+----+----+----+ |
router_ident | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
published |
+----+----+----+----+----+----+----+----+
RouterAddress 0 | +----+ + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
RouterAddress 1 | + + | | ~ ~ ~ ~ | |
+----+----+----+----+----+----+----+----+ |
RouterAddress ($size-1) | + + | | ~ ~ ~ ~ | |
+----+----+----+----+-//-+----+----+----+ options
| +----+----+----+----+-//-+----+----+----+ |
signature | + + | | + + | | + + | | + + | |
+----+----+----+----+----+----+----+----+</p>
<dl>
<dt>router_ident :: [RouterIdentity]</dt>
<dd>length -&gt; &gt;= 387+ bytes</dd>
<dt>published :: [Date]</dt>
<dd>length -&gt; 8 bytes</dd>
<dt>size :: [Integer]</dt>
<dd>length -&gt; 1 byte The number of [RouterAddress]es to follow,
0-255</dd>
<dt>addresses :: [[RouterAddress]]</dt>
<dd>length -&gt; varies</dd>
<dt>peer_size :: [Integer]</dt>
<dd>length -&gt; 1 byte The number of peer [Hash]es to follow, 0-255,
unused, always zero value -&gt; 0</dd>
</dl>
<p>options :: [Mapping]</p>
<dl>
<dt>signature :: [Signature]</dt>
<dd><dl>
<dt>length -&gt; 40 bytes or as specified in router_ident's key</dt>
<dd>
<p>certificate</p>
</dd>
</dl>
</dd>
</dl>
</blockquote>
<p>[Hash]: /spec/common-structures#type-hash [Mapping]:
/spec/common-structures#type-mapping [RouterAddress]:
/spec/common-structures#struct-routeraddress [Signature]:
/spec/common-structures#type-signature [Date]:
/spec/common-structures#type-date [Integer]:
/spec/common-structures#type-integer [RouterIdentity]:
/spec/common-structures#struct-routeridentity</p>
<h4 id="notes-19">Notes</h4>
<ul>
<li>The peer_size <a href="#integer">Integer</a> may be followed by a list of that
many router hashes. This is currently unused. It was intended for a
form of restricted routes, which is unimplemented. Certain
implementations may require the list to be sorted so the signature
is invariant. To be researched before enabling this feature.</li>
<li>The signature may be verified using the signing public key of the
router_ident.</li>
<li>See the network database page [NETDB-ROUTERINFO] for standard
options that are expected to be present in all router infos.</li>
<li>Very old routers required the addresses to be sorted by the SHA256
of their data so the signature is invariant. This is no longer
required, and not worth implementing for backward compatibility.</li>
</ul>
<p>JavaDoc:
<a href="http://echelon.i2p/javadoc/net/i2p/data/router/RouterInfo.html">http://echelon.i2p/javadoc/net/i2p/data/router/RouterInfo.html</a></p>
<h3 id="struct-DeliveryInstructions">Delivery Instructions</h3>
<p>Tunnel Message Delivery Instructions are defined in the Tunnel Message
Specification [TUNNEL-DELIVERY].</p>
<p>Garlic Message Delivery Instructions are defined in the I2NP Message
Specification [GARLIC-DELIVERY].</p>
<h2 id="references">References</h2>
<dl>
<dt>[ECIES]</dt>
<dd>
<p><a href="https://geti2p.net/spec/ecies">https://geti2p.net/spec/ecies</a></p>
</dd>
<dt>[ECIES-ROUTERS]</dt>
<dd>
<p><a href="https://geti2p.net/spec/ecies-routers">https://geti2p.net/spec/ecies-routers</a></p>
</dd>
<dt>[ELGAMAL]</dt>
<dd>
<p><a href="https://geti2p.net/en/docs/how/cryptography#elgamal">https://geti2p.net/en/docs/how/cryptography#elgamal</a></p>
</dd>
<dt>[ELGAMAL-AES]</dt>
<dd>
<p><a href="https://geti2p.net/en/docs/how/elgamal-aes">https://geti2p.net/en/docs/how/elgamal-aes</a></p>
</dd>
<dt>[GARLIC-DELIVERY]</dt>
<dd>
<p><a href="https://geti2p.net/spec/i2np#struct-garlicclovedeliveryinstructions">https://geti2p.net/spec/i2np#struct-garlicclovedeliveryinstructions</a></p>
</dd>
<dt>[I2CP]</dt>
<dd>
<p><a href="https://geti2p.net/en/docs/protocol/i2cp">https://geti2p.net/en/docs/protocol/i2cp</a></p>
</dd>
<dt>[I2NP]</dt>
<dd>
<p><a href="https://geti2p.net/en/docs/protocol/i2np">https://geti2p.net/en/docs/protocol/i2np</a></p>
</dd>
<dt>[NETDB-ROUTERINFO]</dt>
<dd>
<p><a href="https://geti2p.net/en/docs/how/network-database#routerInfo">https://geti2p.net/en/docs/how/network-database#routerInfo</a></p>
</dd>
<dt>[SSU]</dt>
<dd>
<p><a href="https://geti2p.net/en/docs/transport/ssu">https://geti2p.net/en/docs/transport/ssu</a></p>
</dd>
<dt>[TUNNEL-DELIVERY]</dt>
<dd>
<p><a href="https://geti2p.net/spec/tunnel-message#struct-tunnelmessagedeliveryinstructions">https://geti2p.net/spec/tunnel-message#struct-tunnelmessagedeliveryinstructions</a></p>
</dd>
</dl>

  </div>
</section>



    

    
    <div id="backtotop"><a href="#"></a></div>

    

    

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="https://unpkg.com/feather-icons"></script>
<script src="/i2p.spec/js/fresh.js"></script>
<script src="/i2p.spec/js/jquery.panelslider.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  </body>
</html>
